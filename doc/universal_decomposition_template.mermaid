graph TB
    %% ===== UNIVERSAL FEATURE DECOMPOSITION TEMPLATE =====
    subgraph FeatureSystem ["ğŸ¯ [FEATURE_NAME] Decomposed System"]
        
        %% ===== FACADE LAYER (Always Present) =====
        subgraph FacadeLayer ["ğŸ­ Facade Layer"]
            FeatureFacade["ğŸ¯ [Feature] Facade<br/><<Facade>>"]
            FeatureBuilder["ğŸ—ï¸ [Feature] Builder<br/><<Builder>>"]
            FeatureOrchestrator["ğŸ¼ [Feature] Orchestrator<br/><<Orchestrator>>"]
            ConfigurationManager["âš™ï¸ Configuration Manager<br/><<ConfigManager>>"]
        end
        
        %% ===== STRATEGY LAYER (For Behavioral Variants) =====
        subgraph StrategyLayer ["ğŸ¯ Strategy Layer"]
            direction TB
            
            %% Primary Strategies (Core Behavior Variants)
            subgraph PrimaryStrategies ["Primary Strategies"]
                IPrimaryStrategy["ğŸ”Œ I[Primary] Strategy<br/><<Interface>>"]
                ConcreteStrategyA["ğŸ¯ [Variant A] Strategy<br/><<ConcreteStrategy>>"]
                ConcreteStrategyB["âš¡ [Variant B] Strategy<br/><<ConcreteStrategy>>"]
                ConcreteStrategyC["ğŸ”„ [Variant C] Strategy<br/><<ConcreteStrategy>>"]
            end
            
            %% Secondary Strategies (Supporting Behavior)
            subgraph SecondaryStrategies ["Secondary Strategies"]
                ISecondaryStrategy["ğŸ”Œ I[Secondary] Strategy<br/><<Interface>>"]
                SecondaryStrategyA["ğŸ“Š [Secondary A] Strategy<br/><<ConcreteStrategy>>"]
                SecondaryStrategyB["ğŸ”’ [Secondary B] Strategy<br/><<ConcreteStrategy>>"]
                SecondaryStrategyC["â° [Secondary C] Strategy<br/><<ConcreteStrategy>>"]
            end
            
            %% Cross-Cutting Strategies
            subgraph CrossCuttingStrategies ["Cross-Cutting Strategies"]
                ICrossCuttingStrategy["ğŸ”Œ I[CrossCutting] Strategy<br/><<Interface>>"]
                ErrorHandlingStrategy["âŒ Error Handling Strategy<br/><<ConcreteStrategy>>"]
                SecurityStrategy["ğŸ”’ Security Strategy<br/><<ConcreteStrategy>>"]
                PerformanceStrategy["âš¡ Performance Strategy<br/><<ConcreteStrategy>>"]
            end
        end
        
        %% ===== COMMAND LAYER (For Operations) =====
        subgraph CommandLayer ["âš¡ Command Layer"]
            direction TB
            
            %% Command Pattern
            IFeatureCommand["ğŸ”Œ I[Feature] Command<br/><<Interface>>"]
            CommandInvoker["ğŸ“ Command Invoker<br/><<Invoker>>"]
            
            %% Primary Commands (Core Operations)
            subgraph PrimaryCommands ["Primary Commands"]
                CreateCommand["â• Create [Entity] Command<br/><<ConcreteCommand>>"]
                UpdateCommand["âœï¸ Update [Entity] Command<br/><<ConcreteCommand>>"]
                DeleteCommand["ğŸ—‘ï¸ Delete [Entity] Command<br/><<ConcreteCommand>>"]
                ProcessCommand["âš¡ Process [Action] Command<br/><<ConcreteCommand>>"]
            end
            
            %% Management Commands (Lifecycle Operations)
            subgraph ManagementCommands ["Management Commands"]
                InitializeCommand["ğŸš€ Initialize Command<br/><<ConcreteCommand>>"]
                ValidateCommand["âœ… Validate Command<br/><<ConcreteCommand>>"]
                CleanupCommand["ğŸ§¹ Cleanup Command<br/><<ConcreteCommand>>"]
                RefreshCommand["ğŸ”„ Refresh Command<br/><<ConcreteCommand>>"]
            end
            
            %% Command Processing
            CommandProcessor["âš™ï¸ Command Processor<br/><<Processor>>"]
            CommandQueue["ğŸ“ Command Queue<br/><<Queue>>"]
            CommandHistory["ğŸ“œ Command History<br/><<History>>"]
        end
        
        %% ===== STATE MACHINE LAYER (For Complex Workflows) =====
        subgraph StateMachineLayer ["ğŸ”„ State Machine Layer"]
            direction TB
            
            %% State Machine
            FeatureStateMachine["ğŸ”„ [Feature] State Machine<br/><<StateMachine>>"]
            
            %% States (Workflow States)
            subgraph FeatureStates ["Feature States"]
                IdleState["â¸ï¸ Idle State<br/><<ConcreteState>>"]
                ProcessingState["âš¡ Processing State<br/><<ConcreteState>>"]
                CompletedState["âœ… Completed State<br/><<ConcreteState>>"]
                ErrorState["âŒ Error State<br/><<ConcreteState>>"]
                SuspendedState["â¸ï¸ Suspended State<br/><<ConcreteState>>"]
            end
            
            %% State Transitions
            subgraph StateTransitions ["State Transitions"]
                IStateTransition["ğŸ”Œ IState Transition<br/><<Interface>>"]
                StartTransition["â–¶ï¸ Start Transition<br/><<ConcreteTransition>>"]
                CompleteTransition["âœ… Complete Transition<br/><<ConcreteTransition>>"]
                ErrorTransition["âŒ Error Transition<br/><<ConcreteTransition>>"]
                SuspendTransition["â¸ï¸ Suspend Transition<br/><<ConcreteTransition>>"]
            end
            
            %% State Context
            StateContext["ğŸ¯ State Context<br/><<Context>>"]
        end
        
        %% ===== OBSERVER LAYER (For Event Handling) =====
        subgraph ObserverLayer ["ğŸ‘ï¸ Observer Layer"]
            direction TB
            
            %% Event Publisher
            EventPublisher["ğŸ“¡ [Feature] Event Publisher<br/><<Subject>>"]
            
            %% Event Listeners (By Concern)
            subgraph EventListeners ["Event Listeners"]
                IEventListener["ğŸ”Œ I[Feature] Event Listener<br/><<Interface>>"]
                BusinessEventListener["ğŸ’¼ Business Event Listener<br/><<ConcreteObserver>>"]
                AuditEventListener["ğŸ“‹ Audit Event Listener<br/><<ConcreteObserver>>"]
                MetricsEventListener["ğŸ“Š Metrics Event Listener<br/><<ConcreteObserver>>"]
                SecurityEventListener["ğŸ”’ Security Event Listener<br/><<ConcreteObserver>>"]
                NotificationEventListener["ğŸ”” Notification Event Listener<br/><<ConcreteObserver>>"]
            end
            
            %% Events (Domain Events)
            subgraph FeatureEvents ["Feature Events"]
                EntityCreatedEvent["â• [Entity] Created Event<br/><<Event>>"]
                EntityUpdatedEvent["âœï¸ [Entity] Updated Event<br/><<Event>>"]
                EntityDeletedEvent["ğŸ—‘ï¸ [Entity] Deleted Event<br/><<Event>>"]
                ProcessCompletedEvent["âœ… Process Completed Event<br/><<Event>>"]
                ErrorOccurredEvent["âŒ Error Occurred Event<br/><<Event>>"]
            end
        end
        
        %% ===== DECORATOR LAYER (For Cross-Cutting Concerns) =====
        subgraph DecoratorLayer ["ğŸ¨ Decorator Layer"]
            direction TB
            
            %% Base Decorator
            FeatureDecorator["ğŸ¨ [Feature] Decorator<br/><<Decorator>>"]
            
            %% Cross-Cutting Decorators
            subgraph CrossCuttingDecorators ["Cross-Cutting Decorators"]
                CachingDecorator["ğŸ’¾ Caching Decorator<br/><<ConcreteDecorator>>"]
                SecurityDecorator["ğŸ”’ Security Decorator<br/><<ConcreteDecorator>>"]
                AuditDecorator["ğŸ“‹ Audit Decorator<br/><<ConcreteDecorator>>"]
                MetricsDecorator["ğŸ“Š Metrics Decorator<br/><<ConcreteDecorator>>"]
                ValidationDecorator["âœ… Validation Decorator<br/><<ConcreteDecorator>>"]
                RetryDecorator["ğŸ” Retry Decorator<br/><<ConcreteDecorator>>"]
                TimeoutDecorator["â° Timeout Decorator<br/><<ConcreteDecorator>>"]
            end
        end
        
        %% ===== VALIDATION LAYER (For Rules and Constraints) =====
        subgraph ValidationLayer ["âœ… Validation Layer"]
            direction TB
            
            %% Validation Engine
            ValidationEngine["âœ… Validation Engine<br/><<Engine>>"]
            
            %% Validation Rules (By Category)
            subgraph ValidationRules ["Validation Rules"]
                IValidationRule["ğŸ”Œ IValidation Rule<br/><<Interface>>"]
                BusinessRule["ğŸ’¼ Business Rule<br/><<ConcreteRule>>"]
                SecurityRule["ğŸ”’ Security Rule<br/><<ConcreteRule>>"]
                DataIntegrityRule["ğŸ›¡ï¸ Data Integrity Rule<br/><<ConcreteRule>>"]
                ComplianceRule["ğŸ“‹ Compliance Rule<br/><<ConcreteRule>>"]
                PerformanceRule["âš¡ Performance Rule<br/><<ConcreteRule>>"]
            end
            
            %% Validation Components
            subgraph ValidationComponents ["Validation Components"]
                ValidationChain["â›“ï¸ Validation Chain<br/><<ChainOfResponsibility>>"]
                ValidationContext["ğŸ¯ Validation Context<br/><<Context>>"]
                ValidationResult["ğŸ“Š Validation Result<br/><<ValueObject>>"]
            end
        end
        
        %% ===== ADAPTER LAYER (For External Integration) =====
        subgraph AdapterLayer ["ğŸ”§ Adapter Layer"]
            direction TB
            
            %% External Adapters (By Type)
            subgraph ExternalAdapters ["External Adapters"]
                IExternalAdapter["ğŸ”Œ IExternal Adapter<br/><<Interface>>"]
                DatabaseAdapter["ğŸ—„ï¸ Database Adapter<br/><<ConcreteAdapter>>"]
                CacheAdapter["ğŸ’¾ Cache Adapter<br/><<ConcreteAdapter>>"]
                ApiAdapter["ğŸŒ API Adapter<br/><<ConcreteAdapter>>"]
                FileSystemAdapter["ğŸ“ File System Adapter<br/><<ConcreteAdapter>>"]
                MessageQueueAdapter["ğŸ“¨ Message Queue Adapter<br/><<ConcreteAdapter>>"]
            end
            
            %% Connection Management
            subgraph ConnectionManagement ["Connection Management"]
                IConnectionManager["ğŸ”Œ IConnection Manager<br/><<Interface>>"]
                ConnectionPool["ğŸŠ Connection Pool<br/><<Pool>>"]
                ConnectionFactory["ğŸ­ Connection Factory<br/><<Factory>>"]
            end
        end
        
        %% ===== CORE COMPONENTS (Domain Logic) =====
        subgraph CoreComponents ["ğŸ›ï¸ Core Components"]
            direction TB
            
            %% Domain Entities
            subgraph DomainEntities ["Domain Entities"]
                PrimaryEntity["ğŸ¯ [Primary] Entity<br/><<AggregateRoot>>"]
                SecondaryEntity["ğŸ“‹ [Secondary] Entity<br/><<Entity>>"]
                ValueObjects["ğŸ’ Value Objects<br/><<ValueObject>>"]
            end
            
            %% Domain Services
            subgraph DomainServices ["Domain Services"]
                CoreDomainService["ğŸ›ï¸ Core Domain Service<br/><<DomainService>>"]
                CalculationService["ğŸ§® Calculation Service<br/><<DomainService>>"]
                ValidationService["âœ… Validation Service<br/><<DomainService>>"]
            end
            
            %% Repositories
            subgraph Repositories ["Repositories"]
                IRepository["ğŸ”Œ IRepository<br/><<Interface>>"]
                EntityRepository["ğŸ“‹ [Entity] Repository<br/><<ConcreteRepository>>"]
                CachedRepository["ğŸ’¾ Cached Repository<br/><<RepositoryDecorator>>"]
            end
            
            %% Factories
            subgraph Factories ["Factories"]
                EntityFactory["ğŸ­ [Entity] Factory<br/><<Factory>>"]
                StrategyFactory["ğŸ­ Strategy Factory<br/><<Factory>>"]
                AdapterFactory["ğŸ­ Adapter Factory<br/><<Factory>>"]
            end
        end
        
        %% ===== CONFIGURATION LAYER (Settings and Config) =====
        subgraph ConfigurationLayer ["âš™ï¸ Configuration Layer"]
            direction TB
            
            %% Configuration Objects
            subgraph ConfigurationObjects ["Configuration Objects"]
                FeatureConfig["âš™ï¸ [Feature] Configuration<br/><<ValueObject>>"]
                StrategyConfig["ğŸ¯ Strategy Configuration<br/><<ValueObject>>"]
                SecurityConfig["ğŸ”’ Security Configuration<br/><<ValueObject>>"]
                PerformanceConfig["âš¡ Performance Configuration<br/><<ValueObject>>"]
            end
            
            %% Configuration Management
            subgraph ConfigurationManagement ["Configuration Management"]
                ConfigBuilder["ğŸ—ï¸ Config Builder<br/><<Builder>>"]
                ConfigValidator["âœ… Config Validator<br/><<Validator>>"]
                ConfigProvider["ğŸ“¦ Config Provider<br/><<Provider>>"]
            end
        end
    end
    
    %% ===== EXTERNAL DEPENDENCIES =====
    subgraph ExternalDependencies ["ğŸŒ External Dependencies"]
        Logger["ğŸ“ Logger<br/><<Infrastructure>>"]
        MetricsProvider["ğŸ“Š Metrics Provider<br/><<Infrastructure>>"]
        CacheProvider["ğŸ’¾ Cache Provider<br/><<Infrastructure>>"]
        DatabaseProvider["ğŸ—„ï¸ Database Provider<br/><<Infrastructure>>"]
        SecurityProvider["ğŸ”’ Security Provider<br/><<Infrastructure>>"]
        ConfigProvider["âš™ï¸ Config Provider<br/><<Infrastructure>>"]
    end
    
    %% ===== TEMPLATE RELATIONSHIPS (Universal Patterns) =====
    
    %% 1. FACADE ORCHESTRATION (Always present)
    FeatureFacade -->|uses| FeatureBuilder
    FeatureFacade -->|orchestrates| FeatureOrchestrator
    FeatureFacade -->|manages| ConfigurationManager
    FeatureFacade -->|selects| StrategyLayer
    FeatureFacade -->|executes| CommandLayer
    FeatureFacade -->|manages| StateMachineLayer
    FeatureFacade -->|publishes to| ObserverLayer
    FeatureFacade -->|applies| DecoratorLayer
    FeatureFacade -->|validates with| ValidationLayer
    FeatureFacade -->|adapts via| AdapterLayer
    FeatureFacade -->|uses| CoreComponents
    
    %% 2. BUILDER PATTERN (Configuration and Assembly)
    FeatureBuilder -->|builds| CoreComponents
    FeatureBuilder -->|configures| StrategyLayer
    FeatureBuilder -->|assembles| CommandLayer
    FeatureBuilder -->|initializes| StateMachineLayer
    FeatureBuilder -->|wires| ObserverLayer
    FeatureBuilder -->|applies| DecoratorLayer
    FeatureBuilder -->|sets up| ValidationLayer
    FeatureBuilder -->|creates| AdapterLayer
    
    %% 3. STRATEGY PATTERN (Behavioral Variants)
    ConcreteStrategyA -.->|implements| IPrimaryStrategy
    ConcreteStrategyB -.->|implements| IPrimaryStrategy
    ConcreteStrategyC -.->|implements| IPrimaryStrategy
    SecondaryStrategyA -.->|implements| ISecondaryStrategy
    SecondaryStrategyB -.->|implements| ISecondaryStrategy
    SecondaryStrategyC -.->|implements| ISecondaryStrategy
    ErrorHandlingStrategy -.->|implements| ICrossCuttingStrategy
    SecurityStrategy -.->|implements| ICrossCuttingStrategy
    PerformanceStrategy -.->|implements| ICrossCuttingStrategy
    
    %% 4. COMMAND PATTERN (Operations)
    CreateCommand -.->|implements| IFeatureCommand
    UpdateCommand -.->|implements| IFeatureCommand
    DeleteCommand -.->|implements| IFeatureCommand
    ProcessCommand -.->|implements| IFeatureCommand
    InitializeCommand -.->|implements| IFeatureCommand
    ValidateCommand -.->|implements| IFeatureCommand
    CleanupCommand -.->|implements| IFeatureCommand
    RefreshCommand -.->|implements| IFeatureCommand
    
    CommandInvoker -->|queues| CommandQueue
    CommandQueue -->|processes| CommandProcessor
    CommandProcessor -->|logs| CommandHistory
    
    %% 5. STATE MACHINE PATTERN (Complex Workflows)
    FeatureStateMachine -->|manages| FeatureStates
    FeatureStateMachine -->|executes| StateTransitions
    FeatureStateMachine -->|uses| StateContext
    
    StartTransition -.->|implements| IStateTransition
    CompleteTransition -.->|implements| IStateTransition
    ErrorTransition -.->|implements| IStateTransition
    SuspendTransition -.->|implements| IStateTransition
    
    %% 6. OBSERVER PATTERN (Event Handling)
    BusinessEventListener -.->|implements| IEventListener
    AuditEventListener -.->|implements| IEventListener
    MetricsEventListener -.->|implements| IEventListener
    SecurityEventListener -.->|implements| IEventListener
    NotificationEventListener -.->|implements| IEventListener
    
    EventPublisher -->|publishes| FeatureEvents
    EventPublisher -->|notifies| EventListeners
    
    %% 7. DECORATOR PATTERN (Cross-Cutting Concerns)
    CachingDecorator -.->|extends| FeatureDecorator
    SecurityDecorator -.->|extends| FeatureDecorator
    AuditDecorator -.->|extends| FeatureDecorator
    MetricsDecorator -.->|extends| FeatureDecorator
    ValidationDecorator -.->|extends| FeatureDecorator
    RetryDecorator -.->|extends| FeatureDecorator
    TimeoutDecorator -.->|extends| FeatureDecorator
    
    %% 8. CHAIN OF RESPONSIBILITY (Validation)
    BusinessRule -.->|implements| IValidationRule
    SecurityRule -.->|implements| IValidationRule
    DataIntegrityRule -.->|implements| IValidationRule
    ComplianceRule -.->|implements| IValidationRule
    PerformanceRule -.->|implements| IValidationRule
    
    ValidationEngine -->|uses| ValidationChain
    ValidationChain -->|chains| ValidationRules
    
    %% 9. ADAPTER PATTERN (External Integration)
    DatabaseAdapter -.->|implements| IExternalAdapter
    CacheAdapter -.->|implements| IExternalAdapter
    ApiAdapter -.->|implements| IExternalAdapter
    FileSystemAdapter -.->|implements| IExternalAdapter
    MessageQueueAdapter -.->|implements| IExternalAdapter
    
    ConnectionPool -.->|implements| IConnectionManager
    ConnectionFactory -->|creates| ConnectionPool
    
    %% 10. FACTORY PATTERN (Object Creation)
    EntityFactory -->|creates| DomainEntities
    StrategyFactory -->|creates| StrategyLayer
    AdapterFactory -->|creates| AdapterLayer
    
    %% 11. REPOSITORY PATTERN (Data Access)
    EntityRepository -.->|implements| IRepository
    CachedRepository -.->|decorates| EntityRepository
    
    %% 12. EXTERNAL DEPENDENCIES (Infrastructure)
    CoreComponents -->|uses| Logger
    EventListeners -->|uses| MetricsProvider
    DecoratorLayer -->|uses| CacheProvider
    AdapterLayer -->|uses| DatabaseProvider
    ValidationLayer -->|uses| SecurityProvider
    ConfigurationLayer -->|uses| ConfigProvider