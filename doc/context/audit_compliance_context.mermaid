graph TB
    %% ===== AUDIT & COMPLIANCE CONTEXT =====
    subgraph AuditContext ["ğŸ“‹ Audit & Compliance Context"]
        
        %% ===== APPLICATION SERVICE LAYER =====
        subgraph AuditApplicationLayer ["Application Service Layer <<Application>>"]
            AuditApplicationService["ğŸ“‹ Audit Application Service<br/><<ApplicationService>>"]
            
            %% Commands
            subgraph AuditCommands ["Commands"]
                CreateAuditEntryCmd["ğŸ“ Create Audit Entry<br/><<Command>>"]
                StartComplianceAuditCmd["ğŸ” Start Compliance Audit<br/><<Command>>"]
                CompleteComplianceAuditCmd["âœ… Complete Compliance Audit<br/><<Command>>"]
                CreateComplianceReportCmd["ğŸ“„ Create Compliance Report<br/><<Command>>"]
                DefineComplianceRuleCmd["ğŸ“ Define Compliance Rule<br/><<Command>>"]
                UpdateComplianceRuleCmd["âœï¸ Update Compliance Rule<br/><<Command>>"]
                ActivateComplianceRuleCmd["â–¶ï¸ Activate Compliance Rule<br/><<Command>>"]
                DeactivateComplianceRuleCmd["â¸ï¸ Deactivate Compliance Rule<br/><<Command>>"]
                CreateRetentionPolicyCmd["ğŸ—‚ï¸ Create Retention Policy<br/><<Command>>"]
                ExecuteDataPurgeCmd["ğŸ—‘ï¸ Execute Data Purge<br/><<Command>>"]
                FlagComplianceViolationCmd["ğŸš© Flag Violation<br/><<Command>>"]
                ResolveComplianceViolationCmd["âœ… Resolve Violation<br/><<Command>>"]
                ScheduleComplianceCheckCmd["ğŸ“… Schedule Compliance Check<br/><<Command>>"]
            end
            
            %% Queries
            subgraph AuditQueries ["Queries"]
                GetAuditTrailQuery["ğŸ“œ Get Audit Trail<br/><<Query>>"]
                GetComplianceStatusQuery["ğŸ“Š Get Compliance Status<br/><<Query>>"]
                GetComplianceReportQuery["ğŸ“„ Get Compliance Report<br/><<Query>>"]
                GetViolationsQuery["ğŸš© Get Violations<br/><<Query>>"]
                GetRetentionPoliciesQuery["ğŸ—‚ï¸ Get Retention Policies<br/><<Query>>"]
                GetDataInventoryQuery["ğŸ“¦ Get Data Inventory<br/><<Query>>"]
                GetComplianceRulesQuery["ğŸ“ Get Compliance Rules<br/><<Query>>"]
                GetRegulatoryRequirementsQuery["âš–ï¸ Get Regulatory Requirements<br/><<Query>>"]
                GetAccessLogQuery["ğŸ” Get Access Log<br/><<Query>>"]
                GetDataFlowMapQuery["ğŸ—ºï¸ Get Data Flow Map<br/><<Query>>"]
                GetPrivacyImpactAssessmentQuery["ğŸ”’ Get Privacy Impact Assessment<br/><<Query>>"]
                GetCertificationStatusQuery["ğŸ† Get Certification Status<br/><<Query>>"]
            end
            
            %% Sagas
            subgraph AuditSagas ["Sagas"]
                ComplianceAuditSaga["ğŸ” Compliance Audit<br/><<Saga>>"]
                DataRetentionSaga["ğŸ—‚ï¸ Data Retention<br/><<Saga>>"]
                ViolationResolutionSaga["âœ… Violation Resolution<br/><<Saga>>"]
                RegulatoryReportingSaga["ğŸ“„ Regulatory Reporting<br/><<Saga>>"]
                CertificationRenewalSaga["ğŸ”„ Certification Renewal<br/><<Saga>>"]
                IncidentResponseSaga["ğŸš¨ Incident Response<br/><<Saga>>"]
            end
        end
        
        %% ===== DOMAIN LAYER (HEXAGON CORE) =====
        subgraph AuditDomain ["Domain Layer <<DomainCore>>"]
            direction TB
            
            %% Aggregates
            AuditLog["ğŸ“œ Audit Log<br/><<AggregateRoot>>"]
            ComplianceFramework["âš–ï¸ Compliance Framework<br/><<AggregateRoot>>"]
            DataGovernance["ğŸ›¡ï¸ Data Governance<br/><<AggregateRoot>>"]
            RegulatoryCompliance["ğŸ“‹ Regulatory Compliance<br/><<AggregateRoot>>"]
            PrivacyManagement["ğŸ”’ Privacy Management<br/><<AggregateRoot>>"]
            
            %% Entities
            AuditEntry["ğŸ“ Audit Entry<br/><<Entity>>"]
            ComplianceRule["ğŸ“ Compliance Rule<br/><<Entity>>"]
            ComplianceViolation["ğŸš© Compliance Violation<br/><<Entity>>"]
            RetentionPolicy["ğŸ—‚ï¸ Retention Policy<br/><<Entity>>"]
            DataClassification["ğŸ“Š Data Classification<br/><<Entity>>"]
            ComplianceReport["ğŸ“„ Compliance Report<br/><<Entity>>"]
            RegulatoryRequirement["âš–ï¸ Regulatory Requirement<br/><<Entity>>"]
            PrivacyPolicy["ğŸ”’ Privacy Policy<br/><<Entity>>"]
            ConsentRecord["âœ… Consent Record<br/><<Entity>>"]
            DataInventoryItem["ğŸ“¦ Data Inventory Item<br/><<Entity>>"]
            CertificationStatus["ğŸ† Certification Status<br/><<Entity>>"]
            
            %% Value Objects
            AuditId["ğŸ“ Audit ID<br/><<ValueObject>>"]
            ComplianceLevel["ğŸ“Š Compliance Level<br/><<ValueObject>>"]
            ViolationSeverity["âš ï¸ Violation Severity<br/><<ValueObject>>"]
            RetentionPeriod["â° Retention Period<br/><<ValueObject>>"]
            DataSensitivityLevel["ğŸ”’ Data Sensitivity Level<br/><<ValueObject>>"]
            RegulatoryFramework["âš–ï¸ Regulatory Framework<br/><<ValueObject>>"]
            ComplianceScore["ğŸ“Š Compliance Score<br/><<ValueObject>>"]
            AuditTimestamp["ğŸ• Audit Timestamp<br/><<ValueObject>>"]
            
            %% Domain Services
            AuditTrailService["ğŸ“œ Audit Trail<br/><<DomainService>>"]
            ComplianceMonitoringService["ğŸ“Š Compliance Monitoring<br/><<DomainService>>"]
            DataRetentionService["ğŸ—‚ï¸ Data Retention<br/><<DomainService>>"]
            ViolationManagementService["ğŸš© Violation Management<br/><<DomainService>>"]
            RegulatoryReportingService["ğŸ“„ Regulatory Reporting<br/><<DomainService>>"]
            PrivacyComplianceService["ğŸ”’ Privacy Compliance<br/><<DomainService>>"]
            DataGovernanceService["ğŸ›¡ï¸ Data Governance<br/><<DomainService>>"]
            CertificationManagementService["ğŸ† Certification Management<br/><<DomainService>>"]
        end
        
        %% ===== PORTS (DOMAIN INTERFACES) =====
        subgraph AuditPorts ["Ports <<Port>>"]
            direction TB
            
            %% Repository Ports
            IAuditLogRepo["ğŸ“œ IAuditLogRepository<br/><<Port>>"]
            IComplianceFrameworkRepo["âš–ï¸ IComplianceFrameworkRepository<br/><<Port>>"]
            IDataGovernanceRepo["ğŸ›¡ï¸ IDataGovernanceRepository<br/><<Port>>"]
            IRegulatoryComplianceRepo["ğŸ“‹ IRegulatoryComplianceRepository<br/><<Port>>"]
            IPrivacyManagementRepo["ğŸ”’ IPrivacyManagementRepository<br/><<Port>>"]
            
            %% Service Ports
            IAuditingService["ğŸ“ IAuditingService<br/><<Port>>"]
            IComplianceCheckService["âœ… IComplianceCheckService<br/><<Port>>"]
            IDataDiscoveryService["ğŸ” IDataDiscoveryService<br/><<Port>>"]
            IEncryptionService["ğŸ”’ IEncryptionService<br/><<Port>>"]
            INotificationService["ğŸ”” INotificationService<br/><<Port>>"]
            IReportingService["ğŸ“„ IReportingService<br/><<Port>>"]
            IIdentityService["ğŸ†” IIdentityService<br/><<Port>>"]
            IUserService["ğŸ‘¤ IUserService<br/><<Port>>"]
            IOrganizationService["ğŸ¢ IOrganizationService<br/><<Port>>"]
            IMedicalService["ğŸ¥ IMedicalService<br/><<Port>>"]
            IAnalyticsService["ğŸ“Š IAnalyticsService<br/><<Port>>"]
            IAuthenticationService["ğŸ” IAuthenticationService<br/><<Port>>"]
        end
        
        %% ===== INFRASTRUCTURE LAYER (ADAPTERS) =====
        subgraph AuditAdapters ["Infrastructure Layer <<Adapter>>"]
            direction TB
            
            %% Repository Adapters
            subgraph AuditRepositoryAdapters ["Repository Adapters"]
                ImmutableAuditLogRepo["ğŸ”’ Immutable Audit Log Repository<br/><<RepositoryAdapter>>"]
                MongoComplianceFrameworkRepo["ğŸ—„ï¸ Mongo Compliance Framework Repository<br/><<RepositoryAdapter>>"]
                MongoDataGovernanceRepo["ğŸ—„ï¸ Mongo Data Governance Repository<br/><<RepositoryAdapter>>"]
                MongoRegulatoryComplianceRepo["ğŸ—„ï¸ Mongo Regulatory Compliance Repository<br/><<RepositoryAdapter>>"]
                MongoPrivacyManagementRepo["ğŸ—„ï¸ Mongo Privacy Management Repository<br/><<RepositoryAdapter>>"]
            end
            
            %% Service Adapters
            subgraph AuditServiceAdapters ["Service Adapters"]
                BlockchainAuditAdapter["â›“ï¸ Blockchain Audit<br/><<AuditAdapter>>"]
                SOCComplianceAdapter["ğŸ›ï¸ SOC Compliance<br/><<ComplianceAdapter>>"]
                GDPRComplianceAdapter["ğŸ‡ªğŸ‡º GDPR Compliance<br/><<ComplianceAdapter>>"]
                HIPAAComplianceAdapter["ğŸ¥ HIPAA Compliance<br/><<ComplianceAdapter>>"]
                DataDiscoveryAdapter["ğŸ” Data Discovery<br/><<DiscoveryAdapter>>"]
                EncryptionAdapter["ğŸ”’ Encryption<br/><<EncryptionAdapter>>"]
                SlackNotificationAdapter["ğŸ’¬ Slack Notification<br/><<NotificationAdapter>>"]
                ComplianceReportingAdapter["ğŸ“„ Compliance Reporting<br/><<ReportingAdapter>>"]
                IdentityContextAdapter["ğŸ†” Identity Context<br/><<ContextAdapter>>"]
                UserContextAdapter["ğŸ‘¤ User Context<br/><<ContextAdapter>>"]
                OrganizationContextAdapter["ğŸ¢ Organization Context<br/><<ContextAdapter>>"]
                MedicalContextAdapter["ğŸ¥ Medical Context<br/><<ContextAdapter>>"]
                AnalyticsContextAdapter["ğŸ“Š Analytics Context<br/><<ContextAdapter>>"]
                AuthenticationContextAdapter["ğŸ” Authentication Context<br/><<ContextAdapter>>"]
            end
            
            %% Compliance Tools Adapters
            subgraph ComplianceToolsAdapters ["Compliance Tools Adapters"]
                OneTrustAdapter["ğŸ›¡ï¸ OneTrust<br/><<PrivacyAdapter>>"]
                TrustArcAdapter["ğŸ”’ TrustArc<br/><<PrivacyAdapter>>"]
                ServiceNowGRCAdapter["ğŸ“‹ ServiceNow GRC<br/><<GRCAdapter>>"]
                RSAArcherAdapter["ğŸ¹ RSA Archer<br/><<GRCAdapter>>"]
                VantaComplianceAdapter["âœ… Vanta<br/><<ComplianceAdapter>>"]
            end
        end
        
        %% ===== CONTEXT BUS INTERFACES =====
        subgraph AuditContextBus ["Context Bus Interfaces"]
            AuditCommandBus["âš¡ Audit Command Bus<br/><<CommandBus>>"]
            AuditQueryBus["â“ Audit Query Bus<br/><<QueryBus>>"]
            AuditEventBus["ğŸ“¨ Audit Event Bus<br/><<EventBus>>"]
        end
        
        %% ===== POLICY ENFORCEMENT =====
        subgraph AuditPolicyLayer ["Policy Enforcement Layer"]
            AuditPolicyEnforcementPoint["ğŸ›¡ï¸ Audit Policy Enforcement Point<br/><<PEP>>"]
            GDPRPolicyService["ğŸ‡ªğŸ‡º GDPR Policy<br/><<Policy>>"]
            HIPAAPolicyService["ğŸ¥ HIPAA Policy<br/><<Policy>>"]
            SOXPolicyService["ğŸ’¼ SOX Policy<br/><<Policy>>"]
            DataRetentionPolicyService["ğŸ—‚ï¸ Data Retention Policy<br/><<Policy>>"]
            AccessControlPolicyService["ğŸ”’ Access Control Policy<br/><<Policy>>"]
        end
        
        %% ===== COMPLIANCE MONITORING LAYER =====
        subgraph ComplianceMonitoringLayer ["ğŸ“Š Compliance Monitoring Layer"]
            ComplianceMonitor["ğŸ“Š Compliance Monitor<br/><<Monitor>>"]
            ViolationDetector["ğŸš© Violation Detector<br/><<Detector>>"]
            ComplianceScoreCalculator["ğŸ“Š Compliance Score Calculator<br/><<Calculator>>"]
            RegulatoryChangeMonitor["ğŸ“¡ Regulatory Change Monitor<br/><<Monitor>>"]
            CertificationTracker["ğŸ† Certification Tracker<br/><<Tracker>>"]
        end
        
        %% ===== REGULATORY FRAMEWORKS =====
        subgraph RegulatoryFrameworks ["âš–ï¸ Regulatory Frameworks"]
            GDPR["ğŸ‡ªğŸ‡º GDPR Framework<br/><<Framework>>"]
            HIPAA["ğŸ¥ HIPAA Framework<br/><<Framework>>"]
            SOX["ğŸ’¼ SOX Framework<br/><<Framework>>"]
            ISO27001["ğŸ›¡ï¸ ISO 27001 Framework<br/><<Framework>>"]
            SOC2["ğŸ›ï¸ SOC 2 Framework<br/><<Framework>>"]
            PCI_DSS["ğŸ’³ PCI DSS Framework<br/><<Framework>>"]
        end
    end
    
    %% ===== EXTERNAL SYSTEMS =====
    subgraph AuditExternal ["ğŸŒ External Systems"]
        MongoDB["ğŸ—„ï¸ MongoDB<br/><<Database>>"]
        BlockchainLedger["â›“ï¸ Blockchain Ledger<br/><<ImmutableStorage>>"]
        RedisCache["ğŸ”´ Redis<br/><<Cache>>"]
        ElasticsearchCluster["ğŸ” Elasticsearch<br/><<SearchEngine>>"]
        DataLakeStorage["ğŸï¸ Data Lake<br/><<DataStorage>>"]
        OneTrustPlatform["ğŸ›¡ï¸ OneTrust Platform<br/><<PrivacyService>>"]
        TrustArcPlatform["ğŸ”’ TrustArc Platform<br/><<PrivacyService>>"]
        ServiceNowGRC["ğŸ“‹ ServiceNow GRC<br/><<GRCService>>"]
        RSAArcher["ğŸ¹ RSA Archer<br/><<GRCService>>"]
        VantaPlatform["âœ… Vanta Platform<br/><<ComplianceService>>"]
        SlackAPI["ğŸ’¬ Slack API<br/><<NotificationService>>"]
        EmailService["ğŸ“§ Email Service<br/><<NotificationService>>"]
        RegulatoryAPI["ğŸ“¡ Regulatory API<br/><<RegulatoryService>>"]
    end
    
    %% ===== EVENTS =====
    subgraph AuditEvents ["ğŸ“¨ Domain Events"]
        AuditEntryCreatedEvent["ğŸ“ Audit Entry Created<br/><<DomainEvent>>"]
        ComplianceViolationDetectedEvent["ğŸš© Violation Detected<br/><<DomainEvent>>"]
        ComplianceViolationResolvedEvent["âœ… Violation Resolved<br/><<DomainEvent>>"]
        ComplianceAuditStartedEvent["ğŸ” Audit Started<br/><<DomainEvent>>"]
        ComplianceAuditCompletedEvent["âœ… Audit Completed<br/><<DomainEvent>>"]
        RetentionPolicyTriggeredEvent["ğŸ—‚ï¸ Retention Policy Triggered<br/><<DomainEvent>>"]
        DataPurgedEvent["ğŸ—‘ï¸ Data Purged<br/><<DomainEvent>>"]
        RegulatoryChangeDetectedEvent["ğŸ“¡ Regulatory Change Detected<br/><<DomainEvent>>"]
        ComplianceScoreUpdatedEvent["ğŸ“Š Compliance Score Updated<br/><<DomainEvent>>"]
        CertificationExpiredEvent["â° Certification Expired<br/><<DomainEvent>>"]
        CertificationRenewedEvent["ğŸ”„ Certification Renewed<br/><<DomainEvent>>"]
        PrivacyPolicyUpdatedEvent["ğŸ”’ Privacy Policy Updated<br/><<DomainEvent>>"]
        ConsentWithdrawnEvent["âŒ Consent Withdrawn<br/><<DomainEvent>>"]
        UnauthorizedAccessAttemptEvent["ğŸš¨ Unauthorized Access Attempt<br/><<DomainEvent>>"]
        DataBreachDetectedEvent["ğŸš¨ Data Breach Detected<br/><<DomainEvent>>"]
    end
    
    %% ===== READ MODELS =====
    subgraph AuditReadModels ["ğŸ“Š Read Models"]
        AuditTrailRM["ğŸ“œ Audit Trail<br/><<ReadModel>>"]
        ComplianceDashboardRM["ğŸ“Š Compliance Dashboard<br/><<ReadModel>>"]
        ViolationReportRM["ğŸš© Violation Report<br/><<ReadModel>>"]
        ComplianceScoreRM["ğŸ“Š Compliance Score<br/><<ReadModel>>"]
        RegulatoryStatusRM["âš–ï¸ Regulatory Status<br/><<ReadModel>>"]
        DataInventoryRM["ğŸ“¦ Data Inventory<br/><<ReadModel>>"]
        RetentionStatusRM["ğŸ—‚ï¸ Retention Status<br/><<ReadModel>>"]
        PrivacyDashboardRM["ğŸ”’ Privacy Dashboard<br/><<ReadModel>>"]
        CertificationStatusRM["ğŸ† Certification Status<br/><<ReadModel>>"]
        AccessLogRM["ğŸ” Access Log<br/><<ReadModel>>"]
        IncidentResponseRM["ğŸš¨ Incident Response<br/><<ReadModel>>"]
        ComplianceMetricsRM["ğŸ“Š Compliance Metrics<br/><<ReadModel>>"]
    end
    
    %% ===== EXTERNAL CONTEXT REFERENCES =====
    subgraph ExternalContexts ["ğŸŒ External Contexts"]
        UserContext["ğŸ‘¤ User Context<br/><<ExternalContext>>"]
        IdentityContext["ğŸ†” Identity Context<br/><<ExternalContext>>"]
        OrganizationContext["ğŸ¢ Organization Context<br/><<ExternalContext>>"]
        MedicalContext["ğŸ¥ Medical Context<br/><<ExternalContext>>"]
        AnalyticsContext["ğŸ“Š Analytics Context<br/><<ExternalContext>>"]
        AuthenticationContext["ğŸ” Authentication Context<br/><<ExternalContext>>"]
        WorkoutContext["ğŸ’ª Workout Context<br/><<ExternalContext>>"]
        ProgressionContext["ğŸ“ˆ Progression Context<br/><<ExternalContext>>"]
        TrainerContext["ğŸ‘¨â€ğŸ« Trainer Context<br/><<ExternalContext>>"]
        NotificationContext["ğŸ”” Notification Context<br/><<ExternalContext>>"]
    end
    
    %% ===== RELATIONSHIPS =====
    
    %% Application Service orchestrates everything
    AuditApplicationService --> AuditCommandBus
    AuditApplicationService --> AuditQueryBus
    AuditApplicationService --> AuditEventBus
    
    %% Commands and Queries through Application Service
    AuditCommands --> AuditApplicationService
    AuditQueries --> AuditApplicationService
    AuditSagas --> AuditApplicationService
    
    %% Application Service to Domain (orchestration)
    AuditApplicationService --> AuditLog
    AuditApplicationService --> ComplianceFramework
    AuditApplicationService --> DataGovernance
    AuditApplicationService --> RegulatoryCompliance
    AuditApplicationService --> PrivacyManagement
    AuditApplicationService --> AuditTrailService
    AuditApplicationService --> ComplianceMonitoringService
    AuditApplicationService --> DataRetentionService
    AuditApplicationService --> ViolationManagementService
    AuditApplicationService --> RegulatoryReportingService
    AuditApplicationService --> PrivacyComplianceService
    AuditApplicationService --> DataGovernanceService
    AuditApplicationService --> CertificationManagementService
    
    %% Policy Enforcement Integration
    AuditApplicationService --> AuditPolicyEnforcementPoint
    AuditPolicyEnforcementPoint --> GDPRPolicyService
    AuditPolicyEnforcementPoint --> HIPAAPolicyService
    AuditPolicyEnforcementPoint --> SOXPolicyService
    AuditPolicyEnforcementPoint --> DataRetentionPolicyService
    AuditPolicyEnforcementPoint --> AccessControlPolicyService
    
    %% Compliance Monitoring Layer Integration
    ComplianceMonitoringService --> ComplianceMonitoringLayer
    ComplianceMonitor --> ViolationDetector
    ComplianceMonitor --> ComplianceScoreCalculator
    ComplianceMonitor --> RegulatoryChangeMonitor
    ComplianceMonitor --> CertificationTracker
    
    %% Regulatory Frameworks Integration
    ComplianceFramework --> RegulatoryFrameworks
    GDPR --> GDPRComplianceAdapter
    HIPAA --> HIPAAComplianceAdapter
    SOX --> SOCComplianceAdapter
    ISO27001 --> VantaComplianceAdapter
    SOC2 --> ServiceNowGRCAdapter
    PCI_DSS --> RSAArcherAdapter
    
    %% Domain to Ports (Dependency Inversion)
    AuditLog -->|uses| IAuditLogRepo
    AuditLog -->|uses| IAuditingService
    AuditLog -->|uses| IEncryptionService
    ComplianceFramework -->|uses| IComplianceFrameworkRepo
    ComplianceFramework -->|uses| IComplianceCheckService
    DataGovernance -->|uses| IDataGovernanceRepo
    DataGovernance -->|uses| IDataDiscoveryService
    RegulatoryCompliance -->|uses| IRegulatoryComplianceRepo
    RegulatoryCompliance -->|uses| IReportingService
    PrivacyManagement -->|uses| IPrivacyManagementRepo
    PrivacyManagement -->|uses| INotificationService
    AuditTrailService -->|uses| IIdentityService
    ComplianceMonitoringService -->|uses| IAnalyticsService
    DataRetentionService -->|uses| IUserService
    ViolationManagementService -->|uses| IOrganizationService
    RegulatoryReportingService -->|uses| IMedicalService
    PrivacyComplianceService -->|uses| IAuthenticationService
    
    %% Ports to Adapters (Implementation)
    IAuditLogRepo -.->|implements| ImmutableAuditLogRepo
    IComplianceFrameworkRepo -.->|implements| MongoComplianceFrameworkRepo
    IDataGovernanceRepo -.->|implements| MongoDataGovernanceRepo
    IRegulatoryComplianceRepo -.->|implements| MongoRegulatoryComplianceRepo
    IPrivacyManagementRepo -.->|implements| MongoPrivacyManagementRepo
    IAuditingService -.->|implements| BlockchainAuditAdapter
    IComplianceCheckService -.->|implements| SOCComplianceAdapter
    IComplianceCheckService -.->|implements| GDPRComplianceAdapter
    IComplianceCheckService -.->|implements| HIPAAComplianceAdapter
    IDataDiscoveryService -.->|implements| DataDiscoveryAdapter
    IEncryptionService -.->|implements| EncryptionAdapter
    INotificationService -.->|implements| SlackNotificationAdapter
    IReportingService -.->|implements| ComplianceReportingAdapter
    IIdentityService -.->|implements| IdentityContextAdapter
    IUserService -.->|implements| UserContextAdapter
    IOrganizationService -.->|implements| OrganizationContextAdapter
    IMedicalService -.->|implements| MedicalContextAdapter
    IAnalyticsService -.->|implements| AnalyticsContextAdapter
    IAuthenticationService -.->|implements| AuthenticationContextAdapter
    
    %% Compliance Tools Integration
    GDPRComplianceAdapter -.->|integrates| OneTrustAdapter
    PrivacyComplianceService -.->|uses| TrustArcAdapter
    ComplianceMonitoringService -.->|uses| ServiceNowGRCAdapter
    ViolationManagementService -.->|uses| RSAArcherAdapter
    CertificationManagementService -.->|uses| VantaComplianceAdapter
    
    %% Adapters to External Systems
    ImmutableAuditLogRepo -->|connects| BlockchainLedger
    MongoComplianceFrameworkRepo -->|connects| MongoDB
    MongoDataGovernanceRepo -->|connects| MongoDB
    MongoRegulatoryComplianceRepo -->|connects| MongoDB
    MongoPrivacyManagementRepo -->|connects| MongoDB
    BlockchainAuditAdapter -->|connects| BlockchainLedger
    DataDiscoveryAdapter -->|connects| ElasticsearchCluster
    DataDiscoveryAdapter -->|connects| DataLakeStorage
    OneTrustAdapter -->|connects| OneTrustPlatform
    TrustArcAdapter -->|connects| TrustArcPlatform
    ServiceNowGRCAdapter -->|connects| ServiceNowGRC
    RSAArcherAdapter -->|connects| RSAArcher
    VantaComplianceAdapter -->|connects| VantaPlatform
    SlackNotificationAdapter -->|connects| SlackAPI
    ComplianceReportingAdapter -->|connects| EmailService
    RegulatoryChangeMonitor -->|connects| RegulatoryAPI
    
    %% Cross-Context Communication
    IdentityContextAdapter -.->|async calls| IdentityContext
    UserContextAdapter -.->|async calls| UserContext
    OrganizationContextAdapter -.->|async calls| OrganizationContext
    MedicalContextAdapter -.->|async calls| MedicalContext
    AnalyticsContextAdapter -.->|async calls| AnalyticsContext
    AuthenticationContextAdapter -.->|async calls| AuthenticationContext
    
    %% Domain Events
    AuditEntry -.->|publishes| AuditEntryCreatedEvent
    ComplianceViolation -.->|publishes| ComplianceViolationDetectedEvent
    ComplianceViolation -.->|publishes| ComplianceViolationResolvedEvent
    ComplianceMonitoringService -.->|publishes| ComplianceAuditStartedEvent
    ComplianceMonitoringService -.->|publishes| ComplianceAuditCompletedEvent
    RetentionPolicy -.->|publishes| RetentionPolicyTriggeredEvent
    DataRetentionService -.->|publishes| DataPurgedEvent
    RegulatoryChangeMonitor -.->|publishes| RegulatoryChangeDetectedEvent
    ComplianceScoreCalculator -.->|publishes| ComplianceScoreUpdatedEvent
    CertificationStatus -.->|publishes| CertificationExpiredEvent
    CertificationStatus -.->|publishes| CertificationRenewedEvent
    PrivacyPolicy -.->|publishes| PrivacyPolicyUpdatedEvent
    ConsentRecord -.->|publishes| ConsentWithdrawnEvent
    ViolationDetector -.->|publishes| UnauthorizedAccessAttemptEvent
    ViolationDetector -.->|publishes| DataBreachDetectedEvent
    
    %% Event to Read Models (via Event Bus)
    AuditEventBus -.->|projects to| AuditTrailRM
    AuditEventBus -.->|projects to| ComplianceDashboardRM
    AuditEventBus -.->|projects to| ViolationReportRM
    AuditEventBus -.->|projects to| ComplianceScoreRM
    AuditEventBus -.->|projects to| RegulatoryStatusRM
    AuditEventBus -.->|projects to| DataInventoryRM
    AuditEventBus -.->|projects to| RetentionStatusRM
    AuditEventBus -.->|projects to| PrivacyDashboardRM
    AuditEventBus -.->|projects to| CertificationStatusRM
    AuditEventBus -.->|projects to| AccessLogRM
    AuditEventBus -.->|projects to| IncidentResponseRM
    AuditEventBus -.->|projects to| ComplianceMetricsRM
    
    %% Events to Event Bus
    AuditEntryCreatedEvent -.->|publishes to| AuditEventBus
    ComplianceViolationDetectedEvent -.->|publishes to| AuditEventBus
    ComplianceViolationResolvedEvent -.->|publishes to| AuditEventBus
    ComplianceAuditStartedEvent -.->|publishes to| AuditEventBus
    ComplianceAuditCompletedEvent -.->|publishes to| AuditEventBus
    RetentionPolicyTriggeredEvent -.->|publishes to| AuditEventBus
    DataPurgedEvent -.->|publishes to| AuditEventBus
    RegulatoryChangeDetectedEvent -.->|publishes to| AuditEventBus
    ComplianceScoreUpdatedEvent -.->|publishes to| AuditEventBus
    CertificationExpiredEvent -.->|publishes to| AuditEventBus
    CertificationRenewedEvent -.->|publishes to| AuditEventBus
    PrivacyPolicyUpdatedEvent -.->|publishes to| AuditEventBus
    ConsentWithdrawnEvent -.->|publishes to| AuditEventBus
    UnauthorizedAccessAttemptEvent -.->|publishes to| AuditEventBus
    DataBreachDetectedEvent -.->|publishes to| AuditEventBus
    
    %% Sagas listen to events
    ComplianceAuditSaga -.->|listens to| ComplianceAuditStartedEvent
    DataRetentionSaga -.->|listens to| RetentionPolicyTriggeredEvent
    ViolationResolutionSaga -.->|listens to| ComplianceViolationDetectedEvent
    RegulatoryReportingSaga -.->|listens to| RegulatoryChangeDetectedEvent
    CertificationRenewalSaga -.->|listens to| CertificationExpiredEvent
    IncidentResponseSaga -.->|listens to| DataBreachDetectedEvent
    
    %% Context Bus to External Event Bus
    AuditEventBus -.->|integrates with| ExternalContexts
    
    %% External Events Integration (listening to other contexts)
    UserCreated["ğŸ‘¤ User Created<br/><<ExternalEvent>>"]
    DataAccessed["ğŸ” Data Accessed<br/><<ExternalEvent>>"]
    MedicalDataViewed["ğŸ¥ Medical Data Viewed<br/><<ExternalEvent>>"]
    LoginAttempt["ğŸ” Login Attempt<br/><<ExternalEvent>>"]
    PaymentProcessed["ğŸ’³ Payment Processed<br/><<ExternalEvent>>"]
    
    %% External Events to Audit Commands
    UserCreated -.->|triggers| CreateAuditEntryCmd
    DataAccessed -.->|triggers| CreateAuditEntryCmd
    MedicalDataViewed -.->|triggers| CreateAuditEntryCmd
    LoginAttempt -.->|triggers| CreateAuditEntryCmd
    PaymentProcessed -.->|triggers| CreateAuditEntryCmd