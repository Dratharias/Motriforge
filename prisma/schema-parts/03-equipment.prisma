// =====================================
// EQUIPMENT MANAGEMENT
// =====================================

model Equipment {
  id           String   @id @default(cuid())
  name         String   @unique
  description  String?
  manufacturer String?
  model        String?
  visibilityId String   @map("visibility_id")
  isActive     Boolean  @default(true) @map("is_active")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  createdBy    String?  @map("created_by") // Allow null for system data

  // Relations
  visibility    Visibility          @relation(fields: [visibilityId], references: [id], map: "equipment_visibility_fkey")
  createdByUser User?               @relation("EquipmentCreatedBy", fields: [createdBy], references: [id], map: "equipment_created_by_fkey")
  categories    EquipmentCategory[]
  tags          EquipmentTag[]
  exercises     ExerciseEquipment[]
  media         EquipmentMedia[]

  @@map("equipment")
}

model EquipmentCategory {
  equipmentId String   @map("equipment_id")
  categoryId  String   @map("category_id")
  isPrimary   Boolean  @default(false) @map("is_primary")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  createdBy   String?  @map("created_by") // Allow null for system data

  // Relations
  equipment     Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade, map: "equipment_category_equipment_fkey")
  category      Category  @relation(fields: [categoryId], references: [id], map: "equipment_category_category_fkey")
  createdByUser User?     @relation("EquipmentCategoryCreatedBy", fields: [createdBy], references: [id], map: "equipment_category_created_by_fkey")

  @@id([equipmentId, categoryId])
  @@map("equipment_category")
}

model EquipmentTag {
  equipmentId String   @map("equipment_id")
  tagId       String   @map("tag_id")
  isActive    Boolean  @default(true) @map("is_active")
  createdAt   DateTime @default(now()) @map("created_at")
  createdBy   String?  @map("created_by") // Allow null for system data

  // Relations
  equipment     Equipment @relation(fields: [equipmentId], references: [id], onDelete: Cascade, map: "equipment_tag_equipment_fkey")
  tag           Tag       @relation(fields: [tagId], references: [id], map: "equipment_tag_tag_fkey")
  createdByUser User?     @relation("EquipmentTagCreatedBy", fields: [createdBy], references: [id], map: "equipment_tag_created_by_fkey")

  @@id([equipmentId, tagId])
  @@map("equipment_tag")
}
